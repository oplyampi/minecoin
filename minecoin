--[[
File Name: minecoin
Description: Basic Minecoin Client. Designed to be used by any user by having a simple interface. Doesn't support GUIs
Original Creator: Amarite1 (t3kbau5.tk)
Last update: March 29, 2013 @ 11:43 EST
----
Notes:
Channel 7337 is for peer finding
Channel 62646 is for generic Minecoin broadcasts
Channel 7367 is for transactions
]]--
--define constants
pChannel = 7337 --peer channel #
mChannel = 62646 --generic channel #
tChannel = 7367 --transaction notif. channel #

rChannel = os.getComputerID()+1 --reply channel; computer ID +1

--define variables
numPeers = 0 --how many peers are connected?
peers = {} --list of connected peers


--broadcast to the peer-finding network that computer is online
modem = peripheral.wrap('top')
modem.transmit(pChannel, rChannel, "on")
modem.open(pChannel)
modem.open(mChannel)
modem.open(tChannel)
modem.open(rChannel)

--start main stuff
while true do
  local event, modemSide, senderChannel, replyChannel, message = os.pullEvent("modem_message")
  if message ~= "" then
    if message == "on" then
		modem.transmit(pChannel, pChannel, replyChannel)
		peers[numPeers] = replyChannel
	elseif message == "ping"
		modem.transmit(pChannel, pChannel, replyChannel)
	else
		data = textutils.unserialize(message)
		
    end
  end
end